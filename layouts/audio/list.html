{{ define "head" }}
{{ with resources.Get "css/audio.scss" }}
  {{ $opts := dict
    "enableSourceMap" (not hugo.IsProduction)
    "outputStyle" (cond hugo.IsProduction "compressed" "expanded")
    "targetPath" "css/audio.css"
    "transpiler" "libsass"
  }}
  {{ with . | toCSS $opts }}
    {{ if hugo.IsProduction }}
      {{ with . | fingerprint }}
        <link rel="stylesheet" href="{{ .RelPermalink }}" integrity="{{ .Data.Integrity }}" crossorigin="anonymous">
      {{ end }}
    {{ else }}
      <link rel="stylesheet" href="{{ .RelPermalink }}">
    {{ end }}
  {{ end }}
{{ end }}
{{/*<link rel="stylesheet" href="{{ (resources.Get "css/audio.css").Permalink }}">*/}}
<script src="{{ (resources.Get "js/audio.js").Permalink }}" async></script>
{{ end }}

{{ define "main" }}
<ol data-type="playlist">
  {{ range $rec := .RegularPages }}
  <li>
    {{ $img := .Params.image }}
    {{ if eq $img nil }}
      {{/*{{ .Params.project }}*/}}
    {{ end }}
    {{ with .Params.image }}
    {{/*{{ $res_id := print "image/" . }}*/}}
    {{/*{{ $res := resources.Get $res_id }}*/}}
    {{/*{{ with $res }}*/}}
    {{/*<img src="{{ $res.RelPermalink}}"></img>*/}}
    {{/*{{ else }}*/}}
    {{/* {{ warnf "image [%s] not found" $res_id }}*/}}
    {{/*{{ end }}*/}}
    <img src="image/{{ . }}">
    {{ end }}
    <div class="content">
      {{ $path := print "file/" .Params.file }}
      <h6 class="title">{{ .Title | safeHTML }}</h6>
      {{ with .Params.project }}
      <a href="/project/{{.}}" class="project">{{.}}</a>
      {{ end }}
      <div class="text">{{ .Content }}</div>
      {{/*{{ with .Params.project }}*/}}
      {{/*<div>*/}}
        {{/* <span>Project:</span>*/}}
        {{/* <a href="/project/{{- . -}}"><strong>{{- . -}}</strong></a>*/}}
        {{/*</div>*/}}
      {{/*{{ end }}*/}}
    </div>
      <audio src="{{ $path }}" controls></audio>
  </li>
  {{ end }}
</ol>
{{ end }}


{{ define "subnav" }}
<div id="audio-info"></div>
{{ end }}
