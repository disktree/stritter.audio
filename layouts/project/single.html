{{ define "main" }}
{{ $id := .File.ContentBaseName }}
<article class="project">
    
    <header>
        <h2>{{- .Title | safeHTML -}}</h2>
    </header>

    <div class="content">{{- .Content | safeHTML -}}</div>

    {{ with .Params.links }}
        <ul class="nolist">
        {{ range . }}
            <li>
                <i class="ic-double_arrow"></i>
                <a href="{{- . -}}">{{- . -}}</a>
            </li> 
        {{ end }}
        </ul>
        <br>
    {{ end }}

    {{ $events := where (where .Site.RegularPages "Section" "live") "Params.project" "==" $id }}
    {{ if gt (len $events) 0 }}
    <label>project events</label>
    <table>
        {{ range $event := $events }}
            {{ if eq $event.Params.project $id }}
                {{ .Render "tr" }}
            {{ end }}
        {{ end }}
    </table>
    {{ end }}
    
    <!--{{ with .Resources.ByType "audio" }}
    <br>
    <label>audio files</label>
    <ol class="nolist">
        {{ range . }}
        <li>
            <i class="ic-audiotrack"></i>
            <a href="{{.RelPermalink}}">{{- .Name | safeHTML -}}</a>
        </li>
        {{ end }}
    </ol>
    {{ end }}-->
    
    <!--{{ range $res := .Resources.ByType "image" }}
    <img src="{{ .RelPermalink }}">
    {{ end }}-->

</article>
{{ end }}

{{ define "subnav" }}
    {{ partial "prev_next" . }}
{{ end }}

{{ define "background-media" }}
<!--
{{ $id := .File.ContentBaseName }}
{{ if .Params.video }}
    {{ $video := resources.Get (print "video/" $id ".mp4") }}
    {{ if $video }}
        {{ $start := .Params.video.start | default 0 }}
        {{ $src := print $video.Permalink "#t=" $start }}
        <div id="background-media">
            <video src="{{ $src }}" autoplay muted></video>
            <div class="gradient"></div>
        </div>
    {{ end }}
{{ end }}
-->
{{ end }}
